<div id="add-habit-form" class="col-11 col-md-6 col-lg-4 col-xl-4">
  <h3>Add a habit</h3>
    <%# IF RELATIONSHIP DATA IS PRESENT... %>
    <% unless session[:user_data] == nil %>
      <%# FORM IF WE HAVE DATA ON A PARENT RELATION %>
      <% if session[:user_data]["step2"]["relation_to"] == "Parent" %>
        <%= render partial: 'habits/form_parent' %>
      <%# FORM IF WE HAVE DATA ON A CHILD RELATIONSHIP %>
      <% elsif session[:user_data]["step2"]["relation_to"] == "Child" %>
        <%= render partial: 'habits/form_child' %>
      <%# FORM IF WE HAVE DATA ON A PARTNER RELATIONSHIP %>
      <% elsif session[:user_data]["step2"]["relation_to"] == "Partner" %>
        <%= render partial: 'habits/form_partner' %>
      <% end %>
    <%# FORM IF WE HAVE DATA ON ANY OTHER RELATIONSHIP (DEFAULT) %>
    <% else %>
      <%= simple_form_for(@habit) do |f| %>
        <%= f.input :title, :label => 'I will:', placeholder: "volunteer, arrange date night, do something nice for...", input_html: { "data-tooltip" => true, :class => "has-tip", :title => "Bla bla bla" } %>
        <div class="week-recurrence">
          <p>I will do this every </p>
          <%= f.input :week_recurrence, label: false, placeholder: "2" %>
          <p>week/s on these days:</p>
        </div>
          <% days_of_week = Date::DAYNAMES.rotate(1) %>
          <%# Days of the week toggles %>
        <div class="days-checkboxes">
          <% days_of_week.each do |day| %>
            <%= check_box_tag "habit[days_of_week][]", day.downcase, (f.object.days_of_week || []).include?(day.downcase), id: "day_#{day.downcase}" %>
            <%= label_tag "day_#{day.downcase}", day[0], class: 'day-checkbox-label' %>
          <% end %>
        </div>
        <div class="time-duration">
          <p>at:</p>
          <%= f.input :start_time, label: false, as: :time, default: Time.parse('12:00') %>
          <p>for</p>
          <%= f.input :duration_in_minutes, label: false, placeholder: "15" %>
          <p>minutes.</p>
        </div>
        <div class="input-with-tooltip d-flex justify-content-between align-items-start">
          <p>I will do this because I want to be:</p>
          <button type="button" data-toggle="tooltip" data-placement="left" title="Tooltip on left">
            <i class="fa-solid fa-circle-info"></i>
          </button>

        </div>
        <%= f.input :identity_goal, label: false, placeholder: "a good citizen, a thoughtful friend..." %>
        <%= f.input :category, :label => 'Habit category:', as: :select, collection: Habit::CATEGORIES %>
        <%# How can we make the categories look more like chips? %>
        <%= f.input :trigger, :label => 'I will do this before/while/after:', placeholder: "after brushing my teeth, after payday, while walking the dog..." %>
        <%= f.input :reward, :label => 'My reward for this is:', placeholder: "coffee, cake, an episode of The Office" %>
        <%= f.input :photo, :label => 'Attach a photograph to this habit:', as: :file, input_html: { class: 'custom-file-input' }  %>
        <%= f.submit %>
      <% end %>
  <% end %>
</div>
